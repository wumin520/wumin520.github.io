(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[63],{"He/c":function(e,t,a){"use strict";a.r(t);a("Q9mQ");var r,n,s,o,i=a("diRs"),l=(a("Pwec"),a("CtXQ")),c=(a("14J3"),a("BMrR")),m=(a("+L6B"),a("2/Rp")),d=(a("jCWc"),a("kPKH")),p=(a("5NDa"),a("5rEg")),g=(a("MXD1"),a("CFYs")),u=a("p0pE"),h=a.n(u),f=a("2Taf"),v=a.n(f),E=a("vZ4D"),b=a.n(E),w=a("l4Ni"),y=a.n(w),M=a("ujKo"),k=a.n(M),C=a("MhPg"),F=a.n(C),P=(a("y8nQ"),a("Vl3Y")),S=a("q1tI"),j=a.n(S),O=a("MuoO"),I=a("Y2fQ"),D=a("mOP9"),N=a("usdK"),q=a("34ay"),V=a("4DEn"),_=a.n(V),z=P["a"].Item,G={ok:j.a.createElement("div",{className:_.a.success},j.a.createElement(I["FormattedMessage"],{id:"validation.password.strength.strong"})),pass:j.a.createElement("div",{className:_.a.warning},j.a.createElement(I["FormattedMessage"],{id:"validation.password.strength.medium"})),poor:j.a.createElement("div",{className:_.a.error},j.a.createElement(I["FormattedMessage"],{id:"validation.password.strength.short"}))},x={ok:"success",pass:"normal",poor:"exception"},A=(r=Object(O["connect"])(function(e){var t=e.register,a=e.loading,r=e.setting;return{register:t,setting:r,submitting:a.effects["register/submit"],codeGetting:a.effects["login/getCaptcha"]}}),n=P["a"].create(),r(s=n((o=function(e){function t(){var e,a;v()(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return a=y()(this,(e=k()(t)).call.apply(e,[this].concat(n))),a.state={count:0,confirmDirty:!1,visible:!1,help:"",captchaImg:""},a.onGetCaptchaImg=function(){var e=a.props.setting.configs,t=(1e4*Math.random()).toString();a.captcha_rand=t;var r="".concat(e[{API_ENV:"test"}.API_ENV].API_SERVER,"/cdk/phrase?_version=").concat(t);a.setState({captchaImg:r})},a.onGetCaptcha=function(){console.log(a.loginForm.validateFields,"loginForm");var e=a.props.form;e.validateFields(["mobile"],{},function(e,t){if(!e){var r=a.props.dispatch;r({type:"login/getCaptcha",payload:{mobile:t.mobile}}).then(function(){a.startCountDown()})}})},a.startCountDown=function(){var e=59;a.setState({count:e}),a.interval=setInterval(function(){e-=1,a.setState({count:e}),0===e&&clearInterval(a.interval)},1e3)},a.getPasswordStatus=function(){var e=a.props.form,t=e.getFieldValue("password");return t&&t.length>9?"ok":t&&t.length>5?"pass":"poor"},a.handleSubmit=function(e){e.preventDefault();var t=a.props,r=t.form,n=t.dispatch;r.validateFields({force:!0},function(e,t){e||n({type:"register/submit",payload:h()({},t,{_version:a.captcha_rand})})})},a.handleConfirmBlur=function(e){var t=e.target.value,r=a.state.confirmDirty;a.setState({confirmDirty:r||!!t})},a.checkConfirm=function(e,t,r){var n=a.props.form;t&&t!==n.getFieldValue("password")?r(Object(I["formatMessage"])({id:"validation.password.twice"})):r()},a.checkPassword=function(e,t,r){var n=a.state,s=n.visible,o=n.confirmDirty;if(t)if(a.setState({help:""}),s||a.setState({visible:!!t}),t.length<6)r("error");else{var i=a.props.form;t&&o&&i.validateFields(["confirm"],{force:!0}),r()}else a.setState({help:Object(I["formatMessage"])({id:"validation.password.required"}),visible:!!t}),r("error")},a.renderPasswordProgress=function(){var e=a.props.form,t=e.getFieldValue("password"),r=a.getPasswordStatus();return t&&t.length?j.a.createElement("div",{className:_.a["progress-".concat(r)]},j.a.createElement(g["a"],{status:x[r],className:_.a.progress,strokeWidth:6,percent:10*t.length>100?100:10*t.length,showInfo:!1})):null},a}return F()(t,e),b()(t,[{key:"componentWillMount",value:function(){var e=Object(q["c"])();console.log("reigister -> componentWillMount -> sh_state -> ",e,typeof e);var t=this.props.location.query;t.s&&Object(q["g"])(t.s)}},{key:"componentDidMount",value:function(){this.onGetCaptchaImg()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.form,a=e.register,r=t.getFieldValue("mail");"ok"===a.status&&N["a"].push({pathname:"/user/register-result",state:{account:r}})}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.props,a=t.form,r=t.submitting,n=t.codeGetting,s=a.getFieldDecorator,o=this.state,g=o.count,u=o.help,h=o.visible,f=o.captchaImg;return j.a.createElement("div",{className:_.a.main},j.a.createElement("h3",{style:{textAlign:"center"}},"\u6ce8\u518c\u8d85\u591a\u5ba2\u8d26\u53f7"),j.a.createElement(P["a"],{ref:function(t){e.loginForm=t},onSubmit:this.handleSubmit},j.a.createElement(z,null,s("mobile",{defaultValue:"",rules:[{required:!0,message:Object(I["formatMessage"])({id:"validation.phone-number.required"})},{pattern:/^\d{11}$/,message:Object(I["formatMessage"])({id:"validation.phone-number.wrong-format"})}]})(j.a.createElement(p["a"],{size:"large",placeholder:Object(I["formatMessage"])({id:"form.phone-number.placeholder"})}))),j.a.createElement(z,null,j.a.createElement(c["a"],{gutter:8},j.a.createElement(d["a"],{span:16},s("verification_code",{rules:[{required:!0,message:Object(I["formatMessage"])({id:"validation.verification-code.required"})}]})(j.a.createElement(p["a"],{size:"large",placeholder:Object(I["formatMessage"])({id:"form.verification-code.placeholder"})}))),j.a.createElement(d["a"],{span:8},j.a.createElement(m["a"],{size:"large",disabled:g,className:_.a.getCaptcha,onClick:this.onGetCaptcha,loading:n},g?"".concat(g," s"):Object(I["formatMessage"])({id:"app.register.get-verification-code"}))))),j.a.createElement(z,null,j.a.createElement(c["a"],{type:"flex",align:"middle",gutter:8},j.a.createElement(d["a"],{span:16},s("phrase",{defaultValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u56fe\u7247\u9a8c\u8bc1\u7801"}]})(j.a.createElement(p["a"],{size:"large",placeholder:"\u56fe\u7247\u9a8c\u8bc1\u7801"}))),j.a.createElement(d["a"],{span:6},j.a.createElement("img",{style:{width:"100%",height:"auto",display:"block"},alt:"",src:f})),j.a.createElement(d["a"],{span:2},j.a.createElement(l["a"],{onClick:this.onGetCaptchaImg,type:"sync"})))),j.a.createElement(z,{help:u},j.a.createElement(i["a"],{getPopupContainer:function(e){return e.parentNode},content:j.a.createElement("div",{style:{padding:"4px 0"}},G[this.getPasswordStatus()],this.renderPasswordProgress(),j.a.createElement("div",{style:{marginTop:10}},j.a.createElement(I["FormattedMessage"],{id:"validation.password.strength.msg"}))),overlayStyle:{width:240},placement:"right",visible:h},s("password",{rules:[{validator:this.checkPassword}]})(j.a.createElement(p["a"],{size:"large",type:"password",placeholder:Object(I["formatMessage"])({id:"form.password.placeholder"})})))),j.a.createElement(z,null,s("confirm",{rules:[{required:!0,message:Object(I["formatMessage"])({id:"validation.confirm-password.required"})},{validator:this.checkConfirm}]})(j.a.createElement(p["a"],{size:"large",type:"password",placeholder:Object(I["formatMessage"])({id:"form.confirm-password.placeholder"})}))),j.a.createElement(z,null,j.a.createElement(m["a"],{style:{width:"100%",fontSize:"14px"},size:"large",loading:r,type:"primary",htmlType:"submit"},j.a.createElement(I["FormattedMessage"],{id:"app.register.register"}))),j.a.createElement(z,{style:{textAlign:"center"}},"\u5df2\u6709\u8d85\u591a\u5ba2\u8d26\u53f7\uff1f",j.a.createElement(D["a"],{to:"/User/Login"},"\u76f4\u63a5\u767b\u5f55"))))}}]),t}(S["Component"]),s=o))||s)||s);t["default"]=A}}]);